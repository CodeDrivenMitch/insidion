<h1>Editing block</h1>
<%= form_for @block, url: {action: @action}, html: {role: 'form', :class => 'form-horizontal '} do |f| %>
    <div class="form-group">
      <label for="title" class="col-sm-1 control-label">Title:</label>

      <div class="col-sm-8">
        <%= f.text_field :title, :class => 'form-control', :id => 'title' %>
      </div>
    </div>
    <div class="form-group">
      <label for="active" class="col-sm-1 control-label">Show?:</label>

      <div class="col-sm-1">
        <%= f.check_box :active, :class => 'form-control', :id => 'active' %>
      </div>
    </div>

    <div class="form-group">
      <label for="blocktype" class="col-sm-1 control-label">Type:</label>

      <div class="col-sm-3">
        <% if @block.blockable %>
            <%= f.hidden_field :blockable_type %>
            <p class="form-control-static"><%= @block.blockable_type %></p>
        <% else %>
            <%= f.select :blockable_type, ['Post', 'Project'], :class => 'form-control', :id => 'blocktype' %>
        <% end %>
      </div>
    </div>

    <div class="form-group">
      <% if @block.block_images.count > 0 %>
          We have images!
          <%= @block.block_images %>
      <% else %>

          <%= f.fields_for :block_images do |b| %>
              <%= b.fields_for :upload do |u| %>
                  <%= u.file_field :file %>
              <% end %>
          <% end %>
      <% end %>

    </div>


    <h1>Edit Block content</h1>
    <% if @block.blockable %>
        <%= render @block.blockable_type.downcase, param_name: @block.blockable_type.downcase.to_sym, f: f, block: @block.blockable %>
    <% else %>
        <div data-type="post" class="form-part">
          <%= render 'post', f: f, block: Post.new, param_name: :post %>
        </div>
        <div data-type="project" class="form-part">
          <%= render 'project', f: f, block: Project.new, param_name: :project %>
        </div>
    <% end %>

    <%= f.submit 'Save', :class => 'btn btn-default' %>

<% end %>

<% parent_layout "admin" %>